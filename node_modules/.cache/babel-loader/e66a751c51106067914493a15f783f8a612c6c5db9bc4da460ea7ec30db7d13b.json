{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\confi\\\\Downloads\\\\pdf-summarizer\\\\client\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\n// App.js - Versão Minimalista e Elegante com Suporte ao Vercel Blob\nimport React, { useState, useRef, useEffect, useCallback } from 'react';\nimport './App.css';\nimport ErrorHandler from './components/ErrorHandler';\n\n// Função para determinar a URL da API baseada no ambiente\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction getApiUrl() {\n  if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {\n    return 'http://localhost:5000';\n  }\n  return 'https://server-theta-murex.vercel.app';\n}\nconst API_URL = getApiUrl();\nfunction App() {\n  _s();\n  const [files, setFiles] = useState([]);\n  const [summaries, setSummaries] = useState([]);\n  const [patientName, setPatientName] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [apiStatus, setApiStatus] = useState(null);\n  const [uploadStatus, setUploadStatus] = useState(null);\n  const [processingStage, setProcessingStage] = useState(null);\n  const [currentProcessingFile, setCurrentProcessingFile] = useState(null);\n  const [processedFiles, setProcessedFiles] = useState(0);\n  const [totalFiles, setTotalFiles] = useState(0);\n  const [dragOver, setDragOver] = useState(false);\n  const textAreaRef = useRef(null);\n  const fileInputRef = useRef(null);\n\n  // Verificar status da API ao carregar\n  useEffect(() => {\n    const checkApiStatus = async () => {\n      setApiStatus({\n        status: 'checking',\n        message: 'Verificando conexão...',\n        url: API_URL\n      });\n      try {\n        const response = await fetch(`${API_URL}/api/health`);\n        if (response.ok) {\n          const data = await response.json();\n          setApiStatus({\n            status: 'online',\n            env: data.env,\n            blobSupport: data.blobSupport,\n            limits: data.limits,\n            url: API_URL\n          });\n        } else {\n          setApiStatus({\n            status: 'error',\n            message: `Erro ${response.status}`,\n            url: API_URL\n          });\n        }\n      } catch (error) {\n        setApiStatus({\n          status: 'offline',\n          message: 'Servidor indisponível',\n          error: error.message,\n          url: API_URL\n        });\n      }\n    };\n    checkApiStatus();\n  }, []);\n\n  // Função para reconectar com a API\n  const retryApiConnection = useCallback(() => {\n    setApiStatus({\n      status: 'checking',\n      message: 'Reconectando...',\n      url: API_URL\n    });\n    setTimeout(async () => {\n      try {\n        const response = await fetch(`${API_URL}/api/health`);\n        if (response.ok) {\n          const data = await response.json();\n          setApiStatus({\n            status: 'online',\n            env: data.env,\n            blobSupport: data.blobSupport,\n            limits: data.limits,\n            url: API_URL\n          });\n          setError(null);\n        } else {\n          setApiStatus({\n            status: 'error',\n            message: `Erro ${response.status}`,\n            url: API_URL\n          });\n        }\n      } catch (error) {\n        setApiStatus({\n          status: 'offline',\n          message: 'Servidor indisponível',\n          url: API_URL\n        });\n      }\n    }, 1000);\n  }, []);\n\n  // Função para resetar o estado\n  const handleReset = useCallback(() => {\n    setSummaries([]);\n    setPatientName('');\n    setError(null);\n    setFiles([]);\n    setUploadStatus(null);\n    setProcessingStage(null);\n    setCurrentProcessingFile(null);\n    setProcessedFiles(0);\n    setTotalFiles(0);\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n  }, []);\n\n  // Handlers para drag and drop\n  const handleDragOver = useCallback(e => {\n    e.preventDefault();\n    setDragOver(true);\n  }, []);\n  const handleDragLeave = useCallback(e => {\n    e.preventDefault();\n    setDragOver(false);\n  }, []);\n  const handleDrop = useCallback(e => {\n    e.preventDefault();\n    setDragOver(false);\n    const droppedFiles = Array.from(e.dataTransfer.files);\n    const pdfFiles = droppedFiles.filter(file => file.type === 'application/pdf');\n    if (pdfFiles.length === 0 && droppedFiles.length > 0) {\n      setError('Por favor, solte apenas arquivos PDF válidos.');\n      setTimeout(() => setError(null), 3000);\n      return;\n    }\n    setFiles(prevFiles => [...prevFiles, ...pdfFiles]);\n    setError(null);\n    setUploadStatus(null);\n    setProcessingStage(null);\n  }, []);\n  const handleFileChange = useCallback(e => {\n    const selectedFiles = Array.from(e.target.files);\n    setUploadStatus(null);\n    setProcessingStage(null);\n    const pdfFiles = selectedFiles.filter(file => file.type === 'application/pdf');\n    if (pdfFiles.length === 0 && selectedFiles.length > 0) {\n      setError('Por favor, selecione apenas arquivos PDF válidos.');\n      setTimeout(() => setError(null), 3000);\n      return;\n    }\n    setFiles(prevFiles => [...prevFiles, ...pdfFiles]);\n    setError(null);\n  }, []);\n\n  // Função para remover arquivo\n  const removeFile = useCallback(index => {\n    setFiles(prevFiles => prevFiles.filter((_, i) => i !== index));\n  }, []);\n\n  // Função para limpar todos os arquivos\n  const clearAllFiles = useCallback(() => {\n    setFiles([]);\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n  }, []);\n\n  // NOVA FUNÇÃO: Converter arquivo para base64\n  const fileToBase64 = useCallback(file => {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.readAsDataURL(file);\n      reader.onload = () => {\n        const base64 = reader.result.split(',')[1]; // Remove o prefixo data:...\n        resolve(base64);\n      };\n      reader.onerror = error => reject(error);\n    });\n  }, []);\n\n  // NOVA FUNÇÃO: Upload para arquivos grandes via Vercel Blob\n  const uploadLargeFile = useCallback(async file => {\n    try {\n      const MAX_SIZE = 100 * 1024 * 1024; // 100MB\n\n      if (file.size > MAX_SIZE) {\n        throw new Error(`Arquivo muito grande (${(file.size / 1024 / 1024).toFixed(2)}MB). Máximo: 100MB`);\n      }\n      setUploadStatus({\n        stage: 'convertendo',\n        message: 'Preparando arquivo grande...',\n        timestamp: new Date().toLocaleTimeString()\n      });\n\n      // Converter arquivo para base64\n      const base64Data = await fileToBase64(file);\n      setUploadStatus({\n        stage: 'enviando',\n        message: 'Enviando arquivo grande via Blob...',\n        timestamp: new Date().toLocaleTimeString()\n      });\n\n      // Enviar para rota especial de arquivos grandes\n      const response = await fetch(`${API_URL}/api/upload-large`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          filename: file.name,\n          fileData: base64Data\n        })\n      });\n      if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.message || `Erro ${response.status}`);\n      }\n      return await response.json();\n    } catch (error) {\n      console.error('Erro no upload de arquivo grande:', error);\n      throw error;\n    }\n  }, [fileToBase64]);\n\n  // NOVA FUNÇÃO: Upload para arquivos pequenos (método original)\n  const uploadSmallFile = useCallback(async file => {\n    try {\n      const formData = new FormData();\n      formData.append('pdf', file);\n      const response = await fetch(`${API_URL}/api/upload`, {\n        method: 'POST',\n        body: formData\n      });\n      if (!response.ok) {\n        let errorMessage = `Erro ${response.status}: ${response.statusText}`;\n        try {\n          const errorData = await response.json();\n          if (errorData.message) {\n            errorMessage = errorData.message;\n          }\n\n          // Se o erro for 413 e sugerir upload large, tentar automaticamente\n          if (response.status === 413 && errorData.shouldUseLargeUpload) {\n            console.log('Arquivo muito grande para upload direto, tentando via Blob...');\n            return await uploadLargeFile(file);\n          }\n        } catch (jsonError) {\n          // Continuar com mensagem padrão\n        }\n        throw new Error(errorMessage);\n      }\n      return await response.json();\n    } catch (error) {\n      console.error('Erro no upload de arquivo pequeno:', error);\n      throw error;\n    }\n  }, [uploadLargeFile]);\n\n  // NOVA FUNÇÃO: Determinar método de upload baseado no tamanho\n  const processFile = useCallback(async file => {\n    const fileSizeMB = file.size / (1024 * 1024);\n    const LARGE_FILE_THRESHOLD = 4; // 4MB\n\n    console.log(`Processando arquivo: ${file.name} (${fileSizeMB.toFixed(2)}MB)`);\n    if (fileSizeMB > LARGE_FILE_THRESHOLD) {\n      console.log('Usando método de upload para arquivo grande (Vercel Blob)');\n      return await uploadLargeFile(file);\n    } else {\n      console.log('Usando método de upload direto');\n      return await uploadSmallFile(file);\n    }\n  }, [uploadLargeFile, uploadSmallFile]);\n\n  // FUNÇÃO ATUALIZADA: Upload e processamento principal\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (files.length === 0) {\n      setError('Por favor, selecione pelo menos um arquivo PDF válido.');\n      setTimeout(() => setError(null), 3000);\n      return;\n    }\n    setLoading(true);\n    setError(null);\n    setUploadStatus({\n      stage: 'iniciando',\n      message: 'Iniciando processamento...',\n      timestamp: new Date().toLocaleTimeString()\n    });\n    setProcessingStage('upload');\n    setTotalFiles(files.length);\n    setProcessedFiles(0);\n    const allSummaries = [];\n    const fileErrors = [];\n    const patientNames = {};\n    for (let i = 0; i < files.length; i++) {\n      const file = files[i];\n      const fileNumber = i + 1;\n      const fileSizeMB = (file.size / 1024 / 1024).toFixed(2);\n      setCurrentProcessingFile(file.name);\n      try {\n        // Determinar método de upload\n        const isLargeFile = file.size > 4 * 1024 * 1024;\n        const uploadMethod = isLargeFile ? 'Blob' : 'Direto';\n        setUploadStatus({\n          stage: 'enviando',\n          message: `${uploadMethod} ${fileNumber}/${files.length}: ${file.name.substring(0, 30)}${file.name.length > 30 ? '...' : ''} (${fileSizeMB}MB)`,\n          timestamp: new Date().toLocaleTimeString()\n        });\n        setProcessingStage('processing');\n        setUploadStatus({\n          stage: 'processando',\n          message: `Processando ${fileNumber}/${files.length}: Extraindo dados...`,\n          timestamp: new Date().toLocaleTimeString()\n        });\n\n        // Usar a nova função que determina automaticamente o método\n        const data = await processFile(file);\n        if (!data.summaries || data.summaries.length === 0) {\n          throw new Error(`Não foi possível extrair informações do documento ${file.name}.`);\n        }\n        if (data.patientName) {\n          patientNames[file.name] = data.patientName;\n        }\n        const fileSummaries = data.summaries.map(summary => ({\n          ...summary,\n          fileName: file.name,\n          patientName: data.patientName,\n          processedAt: new Date().toLocaleTimeString(),\n          uploadMethod: data.uploadMethod || 'unknown'\n        }));\n        allSummaries.push(...fileSummaries);\n        if (i === 0 && data.patientName) {\n          setPatientName(data.patientName);\n        }\n        setProcessedFiles(i + 1);\n      } catch (error) {\n        console.error(`Erro ao processar ${file.name}:`, error);\n        fileErrors.push({\n          fileName: file.name,\n          error: error.message,\n          timestamp: new Date().toLocaleTimeString()\n        });\n      }\n    }\n    setProcessingStage('complete');\n    if (allSummaries.length > 0) {\n      setSummaries(allSummaries);\n      if (fileErrors.length > 0) {\n        setUploadStatus({\n          stage: 'aviso',\n          message: `Processados ${allSummaries.length} resultados de ${files.length - fileErrors.length}/${files.length} arquivos.`,\n          details: `Concluído às ${new Date().toLocaleTimeString()}`,\n          timestamp: new Date().toLocaleTimeString()\n        });\n        const errorMessage = fileErrors.map(err => `${err.fileName}: ${err.error}`).join('\\n');\n        setError(`Alguns arquivos não puderam ser processados:\\n\\n${errorMessage}`);\n      } else {\n        setUploadStatus({\n          stage: 'sucesso',\n          message: `Processamento concluído! ${allSummaries.length} resultados de ${files.length} arquivos.`,\n          details: `Finalizado às ${new Date().toLocaleTimeString()}`,\n          timestamp: new Date().toLocaleTimeString()\n        });\n        setError(null);\n      }\n    } else {\n      setUploadStatus({\n        stage: 'erro',\n        message: 'Nenhum resultado foi extraído dos arquivos.',\n        details: `Falha às ${new Date().toLocaleTimeString()}`,\n        timestamp: new Date().toLocaleTimeString()\n      });\n      const errorMessage = fileErrors.map(err => `${err.fileName}: ${err.error}`).join('\\n');\n      setError(`Falha ao processar todos os arquivos:\\n\\n${errorMessage}`);\n    }\n    setLoading(false);\n    setCurrentProcessingFile(null);\n  };\n\n  // Gerar texto formatado para cópia\n  const getSimplifiedTextForCopy = useCallback(() => {\n    if (summaries.length === 0) return '';\n    const resultsByFile = {};\n    summaries.forEach(summary => {\n      const fileName = summary.fileName || 'arquivo_desconhecido';\n      if (!resultsByFile[fileName]) {\n        resultsByFile[fileName] = {\n          patientName: summary.patientName || patientName || \"Paciente\",\n          results: [],\n          processedAt: summary.processedAt\n        };\n      }\n      const lines = summary.content.split('\\n');\n      lines.forEach(line => {\n        if (line.trim() && !line.match(/^SÉRIE|^HEMOGRAMA|^EXAMES/i) && !line.match(/^Paciente:/i)) {\n          resultsByFile[fileName].results.push(line.trim());\n        }\n      });\n    });\n    let formattedText = '';\n    let isFirstFile = true;\n    Object.keys(resultsByFile).forEach(fileName => {\n      if (!isFirstFile) {\n        formattedText += '\\n\\n═══════════════════════════════════════\\n\\n';\n      } else {\n        isFirstFile = false;\n      }\n      const fileData = resultsByFile[fileName];\n      if (fileData.patientName) {\n        formattedText += `PACIENTE: ${fileData.patientName}\\n`;\n        if (fileData.processedAt) {\n          formattedText += `Processado às: ${fileData.processedAt}\\n`;\n        }\n        formattedText += '\\n';\n      }\n      const uniqueResults = [...new Set(fileData.results)];\n      uniqueResults.forEach(result => {\n        formattedText += `${result}\\n`;\n      });\n    });\n    return formattedText;\n  }, [summaries, patientName]);\n\n  // Função para copiar texto\n  const copyToClipboard = useCallback(async () => {\n    if (textAreaRef.current) {\n      try {\n        if (navigator.clipboard && window.isSecureContext) {\n          await navigator.clipboard.writeText(textAreaRef.current.value);\n        } else {\n          textAreaRef.current.select();\n          document.execCommand('copy');\n        }\n        const originalText = textAreaRef.current.value;\n        textAreaRef.current.value = 'Resultados copiados com sucesso!';\n        textAreaRef.current.style.background = '#f0fdf4';\n        textAreaRef.current.style.color = '#166534';\n        setTimeout(() => {\n          textAreaRef.current.value = originalText;\n          textAreaRef.current.style.background = '';\n          textAreaRef.current.style.color = '';\n        }, 2000);\n      } catch (err) {\n        console.error('Erro ao copiar:', err);\n        const originalText = textAreaRef.current.value;\n        textAreaRef.current.value = 'Erro ao copiar. Tente selecionar manualmente.';\n        textAreaRef.current.style.background = '#fef2f2';\n        textAreaRef.current.style.color = '#dc2626';\n        setTimeout(() => {\n          textAreaRef.current.value = originalText;\n          textAreaRef.current.style.background = '';\n          textAreaRef.current.style.color = '';\n        }, 3000);\n      }\n    }\n  }, []);\n\n  // Calcular progresso\n  const calculateProgress = useCallback(() => {\n    if (totalFiles === 0) return 0;\n    return Math.round(processedFiles / totalFiles * 100);\n  }, [processedFiles, totalFiles]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"App\",\n    children: [/*#__PURE__*/_jsxDEV(\"header\", {\n      className: \"App-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"institute-logo\",\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"logo-text\",\n          children: \"Instituto Paulo Godoi\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 518,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 517,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Extrator de Resultados de Exames\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 520,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"subtitle\",\n        children: \"Sistema interno para processamento de laudos laboratoriais\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 521,\n        columnNumber: 9\n      }, this), apiStatus && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `api-status ${apiStatus.status}`,\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"status-indicator\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 526,\n          columnNumber: 13\n        }, this), apiStatus.status === 'online' ? /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [\"Conectado (\", apiStatus.env, \")\", apiStatus.blobSupport && /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"blob-support\",\n            children: \" \\u2022 Blob ativo\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 530,\n            columnNumber: 43\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 528,\n          columnNumber: 15\n        }, this) : apiStatus.status === 'checking' ? /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"Verificando...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 533,\n          columnNumber: 15\n        }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [apiStatus.message, /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"retry-button\",\n            onClick: retryApiConnection,\n            children: \"Tentar novamente\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 536,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 535,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 525,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 516,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      children: [((apiStatus === null || apiStatus === void 0 ? void 0 : apiStatus.status) === 'offline' || (apiStatus === null || apiStatus === void 0 ? void 0 : apiStatus.status) === 'error') && /*#__PURE__*/_jsxDEV(ErrorHandler, {\n        error: `Não foi possível conectar ao servidor. ${apiStatus.message}`,\n        onRetry: retryApiConnection\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 548,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `uploader-container ${dragOver ? 'drag-over' : ''}`,\n        onDragOver: handleDragOver,\n        onDragLeave: handleDragLeave,\n        onDrop: handleDrop,\n        children: [/*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: handleSubmit,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"file-input-container\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"file\",\n              id: \"pdf-upload\",\n              ref: fileInputRef,\n              onChange: handleFileChange,\n              accept: \"application/pdf\",\n              multiple: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 562,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"pdf-upload\",\n              className: `file-label ${dragOver ? 'drag-active' : ''}`,\n              children: dragOver ? 'Solte os arquivos PDF aqui' : files.length > 0 ? `${files.length} arquivo(s) selecionado(s)` : 'Escolher arquivos PDF ou arrastar aqui'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 570,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 561,\n            columnNumber: 13\n          }, this), files.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"selected-files-container\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              children: \"Arquivos Selecionados\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 584,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"files-actions\",\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                className: \"clear-files-button\",\n                onClick: clearAllFiles,\n                disabled: loading,\n                children: \"Remover todos\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 586,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 585,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n              className: \"selected-files-list\",\n              children: files.map((file, index) => {\n                const fileSizeMB = (file.size / 1024 / 1024).toFixed(1);\n                const isLargeFile = file.size > 4 * 1024 * 1024;\n                return /*#__PURE__*/_jsxDEV(\"li\", {\n                  className: \"file-item\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"file-name\",\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      className: \"pdf-icon\",\n                      children: \"\\uD83D\\uDCC4\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 602,\n                      columnNumber: 27\n                    }, this), file.name, /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: `file-size ${isLargeFile ? 'large-file' : ''}`,\n                      children: [\"(\", fileSizeMB, \" MB) \", isLargeFile && '• Via Blob']\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 604,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 601,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    type: \"button\",\n                    className: \"remove-file-button\",\n                    onClick: () => removeFile(index),\n                    disabled: loading,\n                    children: \"\\xD7\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 608,\n                    columnNumber: 25\n                  }, this)]\n                }, `${file.name}-${index}`, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 600,\n                  columnNumber: 23\n                }, this);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 595,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 583,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            className: `upload-button ${loading ? 'loading' : ''}`,\n            disabled: files.length === 0 || (apiStatus === null || apiStatus === void 0 ? void 0 : apiStatus.status) !== 'online' || loading,\n            children: loading ? 'Processando...' : 'Extrair Resultados'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 623,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 560,\n          columnNumber: 11\n        }, this), (processingStage === 'upload' || processingStage === 'processing') && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"progress-bar-container\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"progress-bar\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"progress-indicator\",\n              style: {\n                width: `${calculateProgress()}%`\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 636,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 635,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"progress-status\",\n            children: currentProcessingFile ? `${processingStage === 'upload' ? 'Enviando' : 'Processando'}: ${currentProcessingFile.length > 30 ? currentProcessingFile.substring(0, 30) + '...' : currentProcessingFile} (${processedFiles + 1}/${totalFiles})` : processingStage === 'upload' ? 'Enviando arquivo...' : 'Processando documento...'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 641,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 634,\n          columnNumber: 13\n        }, this), uploadStatus && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `upload-status ${uploadStatus.stage}`,\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"status-icon\",\n            children: uploadStatus.stage === 'sucesso' ? '✓' : uploadStatus.stage === 'erro' ? '✗' : uploadStatus.stage === 'aviso' ? '!' : '⟳'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 658,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"status-content\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"status-message\",\n              children: uploadStatus.message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 664,\n              columnNumber: 17\n            }, this), uploadStatus.details && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"status-details\",\n              children: uploadStatus.details\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 666,\n              columnNumber: 19\n            }, this), uploadStatus.timestamp && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"status-timestamp\",\n              children: uploadStatus.timestamp\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 669,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 663,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 657,\n          columnNumber: 13\n        }, this), uploadStatus && uploadStatus.stage === 'erro' && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"pdf-tips\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            children: \"Poss\\xEDveis solu\\xE7\\xF5es:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 678,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n            children: [/*#__PURE__*/_jsxDEV(\"li\", {\n              children: \"Verifique se os PDFs n\\xE3o est\\xE3o protegidos por senha\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 680,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n              children: \"Tente salvar os PDFs novamente usando \\\"Salvar como\\\"\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 681,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n              children: \"Se poss\\xEDvel, imprima os documentos para novos PDFs\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 682,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n              children: \"Entre em contato com o laborat\\xF3rio para vers\\xF5es alternativas\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 683,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 679,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 677,\n          columnNumber: 13\n        }, this), uploadStatus && uploadStatus.stage === 'aviso' && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"processing-notice\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Os documentos foram processados, mas alguns podem conter imprecis\\xF5es.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 691,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Verifique os resultados antes de usar.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 692,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 690,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 554,\n        columnNumber: 9\n      }, this), loading && !processingStage && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"loading\",\n        children: \"Processando documentos, aguarde...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 698,\n        columnNumber: 11\n      }, this), error && !uploadStatus && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"error\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 702,\n        columnNumber: 11\n      }, this), error && uploadStatus && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"file-errors\",\n        children: /*#__PURE__*/_jsxDEV(\"details\", {\n          children: [/*#__PURE__*/_jsxDEV(\"summary\", {\n            children: \"Detalhes dos erros\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 709,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"pre\", {\n            className: \"error-details\",\n            children: error\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 710,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 708,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 707,\n        columnNumber: 11\n      }, this), summaries.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"reset-button-container\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"reset-button\",\n          onClick: handleReset,\n          disabled: loading,\n          children: \"Processar novos documentos\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 718,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 717,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"summary-container\",\n        children: summaries.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"empty-message\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Os resultados dos exames aparecer\\xE3o aqui.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 731,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Selecione arquivos PDF para come\\xE7ar.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 732,\n            columnNumber: 15\n          }, this), (apiStatus === null || apiStatus === void 0 ? void 0 : apiStatus.blobSupport) && /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"blob-info\",\n            children: \"\\u2728 Suporte a arquivos grandes ativado (at\\xE9 100MB)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 734,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 730,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-view-container\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: \"Resultados Extra\\xEDdos\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 739,\n            columnNumber: 15\n          }, this), summaries.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"summary-info\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"file-count\",\n              children: [summaries.length, \" resultados extra\\xEDdos\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 742,\n              columnNumber: 19\n            }, this), files.length > 1 && /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"multi-file-notice\",\n              children: [\"de \", files.length, \" arquivos\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 744,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"extraction-time\",\n              children: [\"\\xE0s \", new Date().toLocaleTimeString()]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 746,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 741,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"copy-instructions\",\n            children: \"Lista de resultados pronta para copiar:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 749,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-area-container\",\n            children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n              ref: textAreaRef,\n              className: \"results-text-area\",\n              value: getSimplifiedTextForCopy(),\n              readOnly: true,\n              placeholder: \"Os resultados aparecer\\xE3o aqui...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 751,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: copyToClipboard,\n              className: \"copy-button\",\n              disabled: summaries.length === 0,\n              children: \"Copiar para \\xE1rea de transfer\\xEAncia\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 758,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 750,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 738,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 728,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 545,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"footer\", {\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"\\xA9 2025 - Instituto Paulo Godoi - Sistema de Processamento de Exames\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 772,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"api-info\",\n        children: [\"Ambiente: \", (apiStatus === null || apiStatus === void 0 ? void 0 : apiStatus.env) || 'Desconectado', \" | API: \", API_URL, (apiStatus === null || apiStatus === void 0 ? void 0 : apiStatus.blobSupport) && /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"blob-support\",\n          children: \" \\u2022 Blob\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 775,\n          columnNumber: 38\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 773,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 771,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 515,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"GUMb87bnz+Nna24BkNoOlN0MdX0=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useRef","useEffect","useCallback","ErrorHandler","jsxDEV","_jsxDEV","getApiUrl","window","location","hostname","API_URL","App","_s","files","setFiles","summaries","setSummaries","patientName","setPatientName","loading","setLoading","error","setError","apiStatus","setApiStatus","uploadStatus","setUploadStatus","processingStage","setProcessingStage","currentProcessingFile","setCurrentProcessingFile","processedFiles","setProcessedFiles","totalFiles","setTotalFiles","dragOver","setDragOver","textAreaRef","fileInputRef","checkApiStatus","status","message","url","response","fetch","ok","data","json","env","blobSupport","limits","retryApiConnection","setTimeout","handleReset","current","value","handleDragOver","e","preventDefault","handleDragLeave","handleDrop","droppedFiles","Array","from","dataTransfer","pdfFiles","filter","file","type","length","prevFiles","handleFileChange","selectedFiles","target","removeFile","index","_","i","clearAllFiles","fileToBase64","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","base64","result","split","onerror","uploadLargeFile","MAX_SIZE","size","Error","toFixed","stage","timestamp","Date","toLocaleTimeString","base64Data","method","headers","body","JSON","stringify","filename","name","fileData","errorData","console","uploadSmallFile","formData","FormData","append","errorMessage","statusText","shouldUseLargeUpload","log","jsonError","processFile","fileSizeMB","LARGE_FILE_THRESHOLD","handleSubmit","allSummaries","fileErrors","patientNames","fileNumber","isLargeFile","uploadMethod","substring","fileSummaries","map","summary","fileName","processedAt","push","details","err","join","getSimplifiedTextForCopy","resultsByFile","forEach","results","lines","content","line","trim","match","formattedText","isFirstFile","Object","keys","uniqueResults","Set","copyToClipboard","navigator","clipboard","isSecureContext","writeText","select","document","execCommand","originalText","style","background","color","calculateProgress","Math","round","className","children","_jsxFileName","lineNumber","columnNumber","onClick","onRetry","onDragOver","onDragLeave","onDrop","onSubmit","id","ref","onChange","accept","multiple","htmlFor","disabled","width","readOnly","placeholder","_c","$RefreshReg$"],"sources":["C:/Users/confi/Downloads/pdf-summarizer/client/src/App.js"],"sourcesContent":["// App.js - Versão Minimalista e Elegante com Suporte ao Vercel Blob\r\nimport React, { useState, useRef, useEffect, useCallback } from 'react';\r\nimport './App.css';\r\nimport ErrorHandler from './components/ErrorHandler';\r\n\r\n// Função para determinar a URL da API baseada no ambiente\r\nfunction getApiUrl() {\r\n  if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {\r\n    return 'http://localhost:5000';\r\n  }\r\n  return 'https://server-theta-murex.vercel.app';\r\n}\r\n\r\nconst API_URL = getApiUrl();\r\n\r\nfunction App() {\r\n  const [files, setFiles] = useState([]);\r\n  const [summaries, setSummaries] = useState([]);\r\n  const [patientName, setPatientName] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  const [apiStatus, setApiStatus] = useState(null);\r\n  const [uploadStatus, setUploadStatus] = useState(null);\r\n  const [processingStage, setProcessingStage] = useState(null);\r\n  const [currentProcessingFile, setCurrentProcessingFile] = useState(null);\r\n  const [processedFiles, setProcessedFiles] = useState(0);\r\n  const [totalFiles, setTotalFiles] = useState(0);\r\n  const [dragOver, setDragOver] = useState(false);\r\n  const textAreaRef = useRef(null);\r\n  const fileInputRef = useRef(null);\r\n\r\n  // Verificar status da API ao carregar\r\n  useEffect(() => {\r\n    const checkApiStatus = async () => {\r\n      setApiStatus({ status: 'checking', message: 'Verificando conexão...', url: API_URL });\r\n      \r\n      try {\r\n        const response = await fetch(`${API_URL}/api/health`);\r\n        if (response.ok) {\r\n          const data = await response.json();\r\n          setApiStatus({\r\n            status: 'online',\r\n            env: data.env,\r\n            blobSupport: data.blobSupport,\r\n            limits: data.limits,\r\n            url: API_URL\r\n          });\r\n        } else {\r\n          setApiStatus({\r\n            status: 'error',\r\n            message: `Erro ${response.status}`,\r\n            url: API_URL\r\n          });\r\n        }\r\n      } catch (error) {\r\n        setApiStatus({\r\n          status: 'offline',\r\n          message: 'Servidor indisponível',\r\n          error: error.message,\r\n          url: API_URL\r\n        });\r\n      }\r\n    };\r\n\r\n    checkApiStatus();\r\n  }, []);\r\n\r\n  // Função para reconectar com a API\r\n  const retryApiConnection = useCallback(() => {\r\n    setApiStatus({ status: 'checking', message: 'Reconectando...', url: API_URL });\r\n    setTimeout(async () => {\r\n      try {\r\n        const response = await fetch(`${API_URL}/api/health`);\r\n        if (response.ok) {\r\n          const data = await response.json();\r\n          setApiStatus({ \r\n            status: 'online', \r\n            env: data.env, \r\n            blobSupport: data.blobSupport,\r\n            limits: data.limits,\r\n            url: API_URL \r\n          });\r\n          setError(null);\r\n        } else {\r\n          setApiStatus({ status: 'error', message: `Erro ${response.status}`, url: API_URL });\r\n        }\r\n      } catch (error) {\r\n        setApiStatus({ status: 'offline', message: 'Servidor indisponível', url: API_URL });\r\n      }\r\n    }, 1000);\r\n  }, []);\r\n\r\n  // Função para resetar o estado\r\n  const handleReset = useCallback(() => {\r\n    setSummaries([]);\r\n    setPatientName('');\r\n    setError(null);\r\n    setFiles([]);\r\n    setUploadStatus(null);\r\n    setProcessingStage(null);\r\n    setCurrentProcessingFile(null);\r\n    setProcessedFiles(0);\r\n    setTotalFiles(0);\r\n    \r\n    if (fileInputRef.current) {\r\n      fileInputRef.current.value = '';\r\n    }\r\n  }, []);\r\n\r\n  // Handlers para drag and drop\r\n  const handleDragOver = useCallback((e) => {\r\n    e.preventDefault();\r\n    setDragOver(true);\r\n  }, []);\r\n\r\n  const handleDragLeave = useCallback((e) => {\r\n    e.preventDefault();\r\n    setDragOver(false);\r\n  }, []);\r\n\r\n  const handleDrop = useCallback((e) => {\r\n    e.preventDefault();\r\n    setDragOver(false);\r\n    \r\n    const droppedFiles = Array.from(e.dataTransfer.files);\r\n    const pdfFiles = droppedFiles.filter(file => file.type === 'application/pdf');\r\n    \r\n    if (pdfFiles.length === 0 && droppedFiles.length > 0) {\r\n      setError('Por favor, solte apenas arquivos PDF válidos.');\r\n      setTimeout(() => setError(null), 3000);\r\n      return;\r\n    }\r\n    \r\n    setFiles(prevFiles => [...prevFiles, ...pdfFiles]);\r\n    setError(null);\r\n    setUploadStatus(null);\r\n    setProcessingStage(null);\r\n  }, []);\r\n\r\n  const handleFileChange = useCallback((e) => {\r\n    const selectedFiles = Array.from(e.target.files);\r\n    setUploadStatus(null);\r\n    setProcessingStage(null);\r\n    \r\n    const pdfFiles = selectedFiles.filter(file => file.type === 'application/pdf');\r\n    \r\n    if (pdfFiles.length === 0 && selectedFiles.length > 0) {\r\n      setError('Por favor, selecione apenas arquivos PDF válidos.');\r\n      setTimeout(() => setError(null), 3000);\r\n      return;\r\n    }\r\n    \r\n    setFiles(prevFiles => [...prevFiles, ...pdfFiles]);\r\n    setError(null);\r\n  }, []);\r\n\r\n  // Função para remover arquivo\r\n  const removeFile = useCallback((index) => {\r\n    setFiles(prevFiles => prevFiles.filter((_, i) => i !== index));\r\n  }, []);\r\n\r\n  // Função para limpar todos os arquivos\r\n  const clearAllFiles = useCallback(() => {\r\n    setFiles([]);\r\n    if (fileInputRef.current) {\r\n      fileInputRef.current.value = '';\r\n    }\r\n  }, []);\r\n\r\n  // NOVA FUNÇÃO: Converter arquivo para base64\r\n  const fileToBase64 = useCallback((file) => {\r\n    return new Promise((resolve, reject) => {\r\n      const reader = new FileReader();\r\n      reader.readAsDataURL(file);\r\n      reader.onload = () => {\r\n        const base64 = reader.result.split(',')[1]; // Remove o prefixo data:...\r\n        resolve(base64);\r\n      };\r\n      reader.onerror = error => reject(error);\r\n    });\r\n  }, []);\r\n\r\n  // NOVA FUNÇÃO: Upload para arquivos grandes via Vercel Blob\r\n  const uploadLargeFile = useCallback(async (file) => {\r\n    try {\r\n      const MAX_SIZE = 100 * 1024 * 1024; // 100MB\r\n      \r\n      if (file.size > MAX_SIZE) {\r\n        throw new Error(`Arquivo muito grande (${(file.size / 1024 / 1024).toFixed(2)}MB). Máximo: 100MB`);\r\n      }\r\n      \r\n      setUploadStatus({ \r\n        stage: 'convertendo', \r\n        message: 'Preparando arquivo grande...',\r\n        timestamp: new Date().toLocaleTimeString()\r\n      });\r\n      \r\n      // Converter arquivo para base64\r\n      const base64Data = await fileToBase64(file);\r\n      \r\n      setUploadStatus({ \r\n        stage: 'enviando', \r\n        message: 'Enviando arquivo grande via Blob...',\r\n        timestamp: new Date().toLocaleTimeString()\r\n      });\r\n      \r\n      // Enviar para rota especial de arquivos grandes\r\n      const response = await fetch(`${API_URL}/api/upload-large`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          filename: file.name,\r\n          fileData: base64Data\r\n        })\r\n      });\r\n      \r\n      if (!response.ok) {\r\n        const errorData = await response.json();\r\n        throw new Error(errorData.message || `Erro ${response.status}`);\r\n      }\r\n      \r\n      return await response.json();\r\n      \r\n    } catch (error) {\r\n      console.error('Erro no upload de arquivo grande:', error);\r\n      throw error;\r\n    }\r\n  }, [fileToBase64]);\r\n\r\n  // NOVA FUNÇÃO: Upload para arquivos pequenos (método original)\r\n  const uploadSmallFile = useCallback(async (file) => {\r\n    try {\r\n      const formData = new FormData();\r\n      formData.append('pdf', file);\r\n      \r\n      const response = await fetch(`${API_URL}/api/upload`, {\r\n        method: 'POST',\r\n        body: formData,\r\n      });\r\n      \r\n      if (!response.ok) {\r\n        let errorMessage = `Erro ${response.status}: ${response.statusText}`;\r\n        try {\r\n          const errorData = await response.json();\r\n          if (errorData.message) {\r\n            errorMessage = errorData.message;\r\n          }\r\n          \r\n          // Se o erro for 413 e sugerir upload large, tentar automaticamente\r\n          if (response.status === 413 && errorData.shouldUseLargeUpload) {\r\n            console.log('Arquivo muito grande para upload direto, tentando via Blob...');\r\n            return await uploadLargeFile(file);\r\n          }\r\n        } catch (jsonError) {\r\n          // Continuar com mensagem padrão\r\n        }\r\n        throw new Error(errorMessage);\r\n      }\r\n      \r\n      return await response.json();\r\n      \r\n    } catch (error) {\r\n      console.error('Erro no upload de arquivo pequeno:', error);\r\n      throw error;\r\n    }\r\n  }, [uploadLargeFile]);\r\n\r\n  // NOVA FUNÇÃO: Determinar método de upload baseado no tamanho\r\n  const processFile = useCallback(async (file) => {\r\n    const fileSizeMB = file.size / (1024 * 1024);\r\n    const LARGE_FILE_THRESHOLD = 4; // 4MB\r\n    \r\n    console.log(`Processando arquivo: ${file.name} (${fileSizeMB.toFixed(2)}MB)`);\r\n    \r\n    if (fileSizeMB > LARGE_FILE_THRESHOLD) {\r\n      console.log('Usando método de upload para arquivo grande (Vercel Blob)');\r\n      return await uploadLargeFile(file);\r\n    } else {\r\n      console.log('Usando método de upload direto');\r\n      return await uploadSmallFile(file);\r\n    }\r\n  }, [uploadLargeFile, uploadSmallFile]);\r\n\r\n  // FUNÇÃO ATUALIZADA: Upload e processamento principal\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    if (files.length === 0) {\r\n      setError('Por favor, selecione pelo menos um arquivo PDF válido.');\r\n      setTimeout(() => setError(null), 3000);\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    setError(null);\r\n    setUploadStatus({ \r\n      stage: 'iniciando', \r\n      message: 'Iniciando processamento...',\r\n      timestamp: new Date().toLocaleTimeString()\r\n    });\r\n    setProcessingStage('upload');\r\n    setTotalFiles(files.length);\r\n    setProcessedFiles(0);\r\n\r\n    const allSummaries = [];\r\n    const fileErrors = [];\r\n    const patientNames = {};\r\n\r\n    for (let i = 0; i < files.length; i++) {\r\n      const file = files[i];\r\n      const fileNumber = i + 1;\r\n      const fileSizeMB = (file.size / 1024 / 1024).toFixed(2);\r\n      setCurrentProcessingFile(file.name);\r\n      \r\n      try {\r\n        // Determinar método de upload\r\n        const isLargeFile = file.size > 4 * 1024 * 1024;\r\n        const uploadMethod = isLargeFile ? 'Blob' : 'Direto';\r\n        \r\n        setUploadStatus({ \r\n          stage: 'enviando', \r\n          message: `${uploadMethod} ${fileNumber}/${files.length}: ${file.name.substring(0, 30)}${file.name.length > 30 ? '...' : ''} (${fileSizeMB}MB)`,\r\n          timestamp: new Date().toLocaleTimeString()\r\n        });\r\n        \r\n        setProcessingStage('processing');\r\n        setUploadStatus({ \r\n          stage: 'processando', \r\n          message: `Processando ${fileNumber}/${files.length}: Extraindo dados...`,\r\n          timestamp: new Date().toLocaleTimeString()\r\n        });\r\n        \r\n        // Usar a nova função que determina automaticamente o método\r\n        const data = await processFile(file);\r\n        \r\n        if (!data.summaries || data.summaries.length === 0) {\r\n          throw new Error(`Não foi possível extrair informações do documento ${file.name}.`);\r\n        }\r\n        \r\n        if (data.patientName) {\r\n          patientNames[file.name] = data.patientName;\r\n        }\r\n        \r\n        const fileSummaries = data.summaries.map(summary => ({\r\n          ...summary,\r\n          fileName: file.name,\r\n          patientName: data.patientName,\r\n          processedAt: new Date().toLocaleTimeString(),\r\n          uploadMethod: data.uploadMethod || 'unknown'\r\n        }));\r\n        \r\n        allSummaries.push(...fileSummaries);\r\n        \r\n        if (i === 0 && data.patientName) {\r\n          setPatientName(data.patientName);\r\n        }\r\n        \r\n        setProcessedFiles(i + 1);\r\n        \r\n      } catch (error) {\r\n        console.error(`Erro ao processar ${file.name}:`, error);\r\n        fileErrors.push({ \r\n          fileName: file.name, \r\n          error: error.message,\r\n          timestamp: new Date().toLocaleTimeString()\r\n        });\r\n      }\r\n    }\r\n    \r\n    setProcessingStage('complete');\r\n    \r\n    if (allSummaries.length > 0) {\r\n      setSummaries(allSummaries);\r\n      \r\n      if (fileErrors.length > 0) {\r\n        setUploadStatus({ \r\n          stage: 'aviso', \r\n          message: `Processados ${allSummaries.length} resultados de ${files.length - fileErrors.length}/${files.length} arquivos.`,\r\n          details: `Concluído às ${new Date().toLocaleTimeString()}`,\r\n          timestamp: new Date().toLocaleTimeString()\r\n        });\r\n        \r\n        const errorMessage = fileErrors.map(err => \r\n          `${err.fileName}: ${err.error}`\r\n        ).join('\\n');\r\n        setError(`Alguns arquivos não puderam ser processados:\\n\\n${errorMessage}`);\r\n      } else {\r\n        setUploadStatus({ \r\n          stage: 'sucesso', \r\n          message: `Processamento concluído! ${allSummaries.length} resultados de ${files.length} arquivos.`,\r\n          details: `Finalizado às ${new Date().toLocaleTimeString()}`,\r\n          timestamp: new Date().toLocaleTimeString()\r\n        });\r\n        setError(null);\r\n      }\r\n    } else {\r\n      setUploadStatus({ \r\n        stage: 'erro', \r\n        message: 'Nenhum resultado foi extraído dos arquivos.',\r\n        details: `Falha às ${new Date().toLocaleTimeString()}`,\r\n        timestamp: new Date().toLocaleTimeString()\r\n      });\r\n      \r\n      const errorMessage = fileErrors.map(err => \r\n        `${err.fileName}: ${err.error}`\r\n      ).join('\\n');\r\n      setError(`Falha ao processar todos os arquivos:\\n\\n${errorMessage}`);\r\n    }\r\n    \r\n    setLoading(false);\r\n    setCurrentProcessingFile(null);\r\n  };\r\n\r\n  // Gerar texto formatado para cópia\r\n  const getSimplifiedTextForCopy = useCallback(() => {\r\n    if (summaries.length === 0) return '';\r\n    \r\n    const resultsByFile = {};\r\n    \r\n    summaries.forEach((summary) => {\r\n      const fileName = summary.fileName || 'arquivo_desconhecido';\r\n      \r\n      if (!resultsByFile[fileName]) {\r\n        resultsByFile[fileName] = {\r\n          patientName: summary.patientName || patientName || \"Paciente\",\r\n          results: [],\r\n          processedAt: summary.processedAt\r\n        };\r\n      }\r\n      \r\n      const lines = summary.content.split('\\n');\r\n      lines.forEach((line) => {\r\n        if (line.trim() && \r\n            !line.match(/^SÉRIE|^HEMOGRAMA|^EXAMES/i) && \r\n            !line.match(/^Paciente:/i)) {\r\n          resultsByFile[fileName].results.push(line.trim());\r\n        }\r\n      });\r\n    });\r\n    \r\n    let formattedText = '';\r\n    let isFirstFile = true;\r\n    \r\n    Object.keys(resultsByFile).forEach((fileName) => {\r\n      if (!isFirstFile) {\r\n        formattedText += '\\n\\n═══════════════════════════════════════\\n\\n';\r\n      } else {\r\n        isFirstFile = false;\r\n      }\r\n      \r\n      const fileData = resultsByFile[fileName];\r\n      if (fileData.patientName) {\r\n        formattedText += `PACIENTE: ${fileData.patientName}\\n`;\r\n        if (fileData.processedAt) {\r\n          formattedText += `Processado às: ${fileData.processedAt}\\n`;\r\n        }\r\n        formattedText += '\\n';\r\n      }\r\n      \r\n      const uniqueResults = [...new Set(fileData.results)];\r\n      uniqueResults.forEach(result => {\r\n        formattedText += `${result}\\n`;\r\n      });\r\n    });\r\n    \r\n    return formattedText;\r\n  }, [summaries, patientName]);\r\n\r\n  // Função para copiar texto\r\n  const copyToClipboard = useCallback(async () => {\r\n    if (textAreaRef.current) {\r\n      try {\r\n        if (navigator.clipboard && window.isSecureContext) {\r\n          await navigator.clipboard.writeText(textAreaRef.current.value);\r\n        } else {\r\n          textAreaRef.current.select();\r\n          document.execCommand('copy');\r\n        }\r\n        \r\n        const originalText = textAreaRef.current.value;\r\n        textAreaRef.current.value = 'Resultados copiados com sucesso!';\r\n        textAreaRef.current.style.background = '#f0fdf4';\r\n        textAreaRef.current.style.color = '#166534';\r\n        \r\n        setTimeout(() => {\r\n          textAreaRef.current.value = originalText;\r\n          textAreaRef.current.style.background = '';\r\n          textAreaRef.current.style.color = '';\r\n        }, 2000);\r\n        \r\n      } catch (err) {\r\n        console.error('Erro ao copiar:', err);\r\n        const originalText = textAreaRef.current.value;\r\n        textAreaRef.current.value = 'Erro ao copiar. Tente selecionar manualmente.';\r\n        textAreaRef.current.style.background = '#fef2f2';\r\n        textAreaRef.current.style.color = '#dc2626';\r\n        \r\n        setTimeout(() => {\r\n          textAreaRef.current.value = originalText;\r\n          textAreaRef.current.style.background = '';\r\n          textAreaRef.current.style.color = '';\r\n        }, 3000);\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  // Calcular progresso\r\n  const calculateProgress = useCallback(() => {\r\n    if (totalFiles === 0) return 0;\r\n    return Math.round((processedFiles / totalFiles) * 100);\r\n  }, [processedFiles, totalFiles]);\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <header className=\"App-header\">\r\n        <div className=\"institute-logo\">\r\n          <span className=\"logo-text\">Instituto Paulo Godoi</span>\r\n        </div>\r\n        <h1>Extrator de Resultados de Exames</h1>\r\n        <p className=\"subtitle\">Sistema interno para processamento de laudos laboratoriais</p>\r\n        \r\n        {/* Status da API */}\r\n        {apiStatus && (\r\n          <div className={`api-status ${apiStatus.status}`}>\r\n            <span className=\"status-indicator\"></span>\r\n            {apiStatus.status === 'online' ? (\r\n              <span>\r\n                Conectado ({apiStatus.env})\r\n                {apiStatus.blobSupport && <span className=\"blob-support\"> • Blob ativo</span>}\r\n              </span>\r\n            ) : apiStatus.status === 'checking' ? (\r\n              <span>Verificando...</span>\r\n            ) : (\r\n              <span>{apiStatus.message}\r\n                <button className=\"retry-button\" onClick={retryApiConnection}>\r\n                  Tentar novamente\r\n                </button>\r\n              </span>\r\n            )}\r\n          </div>\r\n        )}\r\n      </header>\r\n      \r\n      <main>\r\n        {/* Error Handler para problemas de API */}\r\n        {(apiStatus?.status === 'offline' || apiStatus?.status === 'error') && (\r\n          <ErrorHandler \r\n            error={`Não foi possível conectar ao servidor. ${apiStatus.message}`}\r\n            onRetry={retryApiConnection}\r\n          />\r\n        )}\r\n        \r\n        <div \r\n          className={`uploader-container ${dragOver ? 'drag-over' : ''}`}\r\n          onDragOver={handleDragOver}\r\n          onDragLeave={handleDragLeave}\r\n          onDrop={handleDrop}\r\n        >\r\n          <form onSubmit={handleSubmit}>\r\n            <div className=\"file-input-container\">\r\n              <input\r\n                type=\"file\"\r\n                id=\"pdf-upload\"\r\n                ref={fileInputRef}\r\n                onChange={handleFileChange}\r\n                accept=\"application/pdf\"\r\n                multiple\r\n              />\r\n              <label htmlFor=\"pdf-upload\" className={`file-label ${dragOver ? 'drag-active' : ''}`}>\r\n                {dragOver ? (\r\n                  'Solte os arquivos PDF aqui'\r\n                ) : files.length > 0 ? (\r\n                  `${files.length} arquivo(s) selecionado(s)`\r\n                ) : (\r\n                  'Escolher arquivos PDF ou arrastar aqui'\r\n                )}\r\n              </label>\r\n            </div>\r\n            \r\n            {/* Lista de arquivos selecionados */}\r\n            {files.length > 0 && (\r\n              <div className=\"selected-files-container\">\r\n                <h3>Arquivos Selecionados</h3>\r\n                <div className=\"files-actions\">\r\n                  <button \r\n                    type=\"button\" \r\n                    className=\"clear-files-button\" \r\n                    onClick={clearAllFiles}\r\n                    disabled={loading}\r\n                  >\r\n                    Remover todos\r\n                  </button>\r\n                </div>\r\n                <ul className=\"selected-files-list\">\r\n                  {files.map((file, index) => {\r\n                    const fileSizeMB = (file.size / 1024 / 1024).toFixed(1);\r\n                    const isLargeFile = file.size > 4 * 1024 * 1024;\r\n                    return (\r\n                      <li key={`${file.name}-${index}`} className=\"file-item\">\r\n                        <span className=\"file-name\">\r\n                          <span className=\"pdf-icon\">📄</span>\r\n                          {file.name}\r\n                          <span className={`file-size ${isLargeFile ? 'large-file' : ''}`}>\r\n                            ({fileSizeMB} MB) {isLargeFile && '• Via Blob'}\r\n                          </span>\r\n                        </span>\r\n                        <button \r\n                          type=\"button\" \r\n                          className=\"remove-file-button\" \r\n                          onClick={() => removeFile(index)}\r\n                          disabled={loading}\r\n                        >\r\n                          ×\r\n                        </button>\r\n                      </li>\r\n                    );\r\n                  })}\r\n                </ul>\r\n              </div>\r\n            )}\r\n            \r\n            <button \r\n              type=\"submit\" \r\n              className={`upload-button ${loading ? 'loading' : ''}`}\r\n              disabled={files.length === 0 || apiStatus?.status !== 'online' || loading}\r\n            >\r\n              {loading ? 'Processando...' : 'Extrair Resultados'}\r\n            </button>\r\n          </form>\r\n          \r\n          {/* Barra de progresso */}\r\n          {(processingStage === 'upload' || processingStage === 'processing') && (\r\n            <div className=\"progress-bar-container\">\r\n              <div className=\"progress-bar\">\r\n                <div \r\n                  className=\"progress-indicator\" \r\n                  style={{ width: `${calculateProgress()}%` }}\r\n                ></div>\r\n              </div>\r\n              <div className=\"progress-status\">\r\n                {currentProcessingFile ? (\r\n                  `${processingStage === 'upload' ? 'Enviando' : 'Processando'}: ${\r\n                    currentProcessingFile.length > 30 ? \r\n                    currentProcessingFile.substring(0, 30) + '...' : \r\n                    currentProcessingFile\r\n                  } (${processedFiles + 1}/${totalFiles})`\r\n                ) : (\r\n                  processingStage === 'upload' ? 'Enviando arquivo...' : 'Processando documento...'\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n          \r\n          {/* Status de upload */}\r\n          {uploadStatus && (\r\n            <div className={`upload-status ${uploadStatus.stage}`}>\r\n              <span className=\"status-icon\">\r\n                {uploadStatus.stage === 'sucesso' ? '✓' : \r\n                uploadStatus.stage === 'erro' ? '✗' : \r\n                uploadStatus.stage === 'aviso' ? '!' : '⟳'}\r\n              </span>\r\n              <div className=\"status-content\">\r\n                <div className=\"status-message\">{uploadStatus.message}</div>\r\n                {uploadStatus.details && (\r\n                  <div className=\"status-details\">{uploadStatus.details}</div>\r\n                )}\r\n                {uploadStatus.timestamp && (\r\n                  <div className=\"status-timestamp\">{uploadStatus.timestamp}</div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n          \r\n          {/* Dicas para PDFs problemáticos */}\r\n          {uploadStatus && uploadStatus.stage === 'erro' && (\r\n            <div className=\"pdf-tips\">\r\n              <h4>Possíveis soluções:</h4>\r\n              <ul>\r\n                <li>Verifique se os PDFs não estão protegidos por senha</li>\r\n                <li>Tente salvar os PDFs novamente usando \"Salvar como\"</li>\r\n                <li>Se possível, imprima os documentos para novos PDFs</li>\r\n                <li>Entre em contato com o laboratório para versões alternativas</li>\r\n              </ul>\r\n            </div>\r\n          )}\r\n          \r\n          {/* Aviso para processamento parcial */}\r\n          {uploadStatus && uploadStatus.stage === 'aviso' && (\r\n            <div className=\"processing-notice\">\r\n              <p>Os documentos foram processados, mas alguns podem conter imprecisões.</p>\r\n              <p>Verifique os resultados antes de usar.</p>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {loading && !processingStage && (\r\n          <p className=\"loading\">Processando documentos, aguarde...</p>\r\n        )}\r\n        \r\n        {error && !uploadStatus && (\r\n          <p className=\"error\">{error}</p>\r\n        )}\r\n        \r\n        {/* Detalhes de erros */}\r\n        {error && uploadStatus && (\r\n          <div className=\"file-errors\">\r\n            <details>\r\n              <summary>Detalhes dos erros</summary>\r\n              <pre className=\"error-details\">{error}</pre>\r\n            </details>\r\n          </div>\r\n        )}\r\n        \r\n        {/* Botão de reset */}\r\n        {summaries.length > 0 && (\r\n          <div className=\"reset-button-container\">\r\n            <button \r\n              className=\"reset-button\"\r\n              onClick={handleReset}\r\n              disabled={loading}\r\n            >\r\n              Processar novos documentos\r\n            </button>\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"summary-container\">\r\n          {summaries.length === 0 ? (\r\n            <div className=\"empty-message\">\r\n              <p>Os resultados dos exames aparecerão aqui.</p>\r\n              <p>Selecione arquivos PDF para começar.</p>\r\n              {apiStatus?.blobSupport && (\r\n                <p className=\"blob-info\">✨ Suporte a arquivos grandes ativado (até 100MB)</p>\r\n              )}\r\n            </div>\r\n          ) : (\r\n            <div className=\"text-view-container\">\r\n              <h2>Resultados Extraídos</h2>\r\n              {summaries.length > 0 && (\r\n                <div className=\"summary-info\">\r\n                  <span className=\"file-count\">{summaries.length} resultados extraídos</span>\r\n                  {files.length > 1 && (\r\n                    <span className=\"multi-file-notice\">de {files.length} arquivos</span>\r\n                  )}\r\n                  <span className=\"extraction-time\">às {new Date().toLocaleTimeString()}</span>\r\n                </div>\r\n              )}\r\n              <p className=\"copy-instructions\">Lista de resultados pronta para copiar:</p>\r\n              <div className=\"text-area-container\">\r\n                <textarea\r\n                  ref={textAreaRef}\r\n                  className=\"results-text-area\"\r\n                  value={getSimplifiedTextForCopy()}\r\n                  readOnly\r\n                  placeholder=\"Os resultados aparecerão aqui...\"\r\n                />\r\n                <button \r\n                  onClick={copyToClipboard} \r\n                  className=\"copy-button\"\r\n                  disabled={summaries.length === 0}\r\n                >\r\n                  Copiar para área de transferência\r\n                </button>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </main>\r\n      \r\n      <footer>\r\n        <p>© 2025 - Instituto Paulo Godoi - Sistema de Processamento de Exames</p>\r\n        <p className=\"api-info\">\r\n          Ambiente: {apiStatus?.env || 'Desconectado'} | API: {API_URL}\r\n          {apiStatus?.blobSupport && <span className=\"blob-support\"> • Blob</span>}\r\n        </p>\r\n      </footer>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}